function cov_w7ki12b4d() {
  var path = "/home/shubham/Desktop/juice-shop/build/routes/profileImageFileUpload.ts";
  var hash = "386a306e799f418c490e96232f18629b7ce9ef60";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "/home/shubham/Desktop/juice-shop/build/routes/profileImageFileUpload.ts",
    statementMap: {
      "0": {
        start: {
          line: 2,
          column: 13
        },
        end: {
          line: 2,
          column: 80
        }
      },
      "1": {
        start: {
          line: 3,
          column: 13
        },
        end: {
          line: 3,
          column: 55
        }
      },
      "2": {
        start: {
          line: 4,
          column: 15
        },
        end: {
          line: 4,
          column: 44
        }
      },
      "3": {
        start: {
          line: 5,
          column: 12
        },
        end: {
          line: 5,
          column: 26
        }
      },
      "4": {
        start: {
          line: 6,
          column: 21
        },
        end: {
          line: 810,
          column: 3
        }
      },
      "5": {
        start: {
          line: 811,
          column: 17
        },
        end: {
          line: 811,
          column: 50
        }
      },
      "6": {
        start: {
          line: 813,
          column: 2
        },
        end: {
          line: 815,
          column: 3
        }
      },
      "7": {
        start: {
          line: 814,
          column: 4
        },
        end: {
          line: 814,
          column: 34
        }
      },
      "8": {
        start: {
          line: 817,
          column: 23
        },
        end: {
          line: 817,
          column: 37
        }
      },
      "9": {
        start: {
          line: 820,
          column: 4
        },
        end: {
          line: 822,
          column: 6
        }
      },
      "10": {
        start: {
          line: 821,
          column: 6
        },
        end: {
          line: 821,
          column: 28
        }
      },
      "11": {
        start: {
          line: 824,
          column: 2
        },
        end: {
          line: 824,
          column: 24
        }
      },
      "12": {
        start: {
          line: 827,
          column: 0
        },
        end: {
          line: 827,
          column: 17
        }
      },
      "13": {
        start: {
          line: 836,
          column: 15
        },
        end: {
          line: 836,
          column: 63
        }
      },
      "14": {
        start: {
          line: 837,
          column: 18
        },
        end: {
          line: 837,
          column: 71
        }
      },
      "15": {
        start: {
          line: 838,
          column: 16
        },
        end: {
          line: 838,
          column: 65
        }
      },
      "16": {
        start: {
          line: 839,
          column: 18
        },
        end: {
          line: 839,
          column: 63
        }
      },
      "17": {
        start: {
          line: 840,
          column: 0
        },
        end: {
          line: 840,
          column: 24
        }
      },
      "18": {
        start: {
          line: 842,
          column: 0
        },
        end: {
          line: 939,
          column: 2
        }
      },
      "19": {
        start: {
          line: 843,
          column: 2
        },
        end: {
          line: 843,
          column: 26
        }
      },
      "20": {
        start: {
          line: 844,
          column: 2
        },
        end: {
          line: 844,
          column: 26
        }
      },
      "21": {
        start: {
          line: 845,
          column: 2
        },
        end: {
          line: 938,
          column: 4
        }
      },
      "22": {
        start: {
          line: 846,
          column: 4
        },
        end: {
          line: 846,
          column: 28
        }
      },
      "23": {
        start: {
          line: 847,
          column: 18
        },
        end: {
          line: 847,
          column: 51
        }
      },
      "24": {
        start: {
          line: 848,
          column: 20
        },
        end: {
          line: 848,
          column: 57
        }
      },
      "25": {
        start: {
          line: 849,
          column: 30
        },
        end: {
          line: 849,
          column: 88
        }
      },
      "26": {
        start: {
          line: 850,
          column: 4
        },
        end: {
          line: 850,
          column: 28
        }
      },
      "27": {
        start: {
          line: 852,
          column: 4
        },
        end: {
          line: 937,
          column: 5
        }
      },
      "28": {
        start: {
          line: 853,
          column: 6
        },
        end: {
          line: 853,
          column: 33
        }
      },
      "29": {
        start: {
          line: 854,
          column: 6
        },
        end: {
          line: 854,
          column: 31
        }
      },
      "30": {
        start: {
          line: 855,
          column: 6
        },
        end: {
          line: 855,
          column: 22
        }
      },
      "31": {
        start: {
          line: 856,
          column: 6
        },
        end: {
          line: 856,
          column: 31
        }
      },
      "32": {
        start: {
          line: 857,
          column: 6
        },
        end: {
          line: 857,
          column: 43
        }
      },
      "33": {
        start: {
          line: 859,
          column: 6
        },
        end: {
          line: 859,
          column: 33
        }
      },
      "34": {
        start: {
          line: 860,
          column: 6
        },
        end: {
          line: 860,
          column: 31
        }
      },
      "35": {
        start: {
          line: 862,
          column: 6
        },
        end: {
          line: 936,
          column: 7
        }
      },
      "36": {
        start: {
          line: 863,
          column: 8
        },
        end: {
          line: 863,
          column: 35
        }
      },
      "37": {
        start: {
          line: 864,
          column: 30
        },
        end: {
          line: 864,
          column: 106
        }
      },
      "38": {
        start: {
          line: 865,
          column: 8
        },
        end: {
          line: 865,
          column: 33
        }
      },
      "39": {
        start: {
          line: 867,
          column: 8
        },
        end: {
          line: 929,
          column: 9
        }
      },
      "40": {
        start: {
          line: 868,
          column: 10
        },
        end: {
          line: 868,
          column: 37
        }
      },
      "41": {
        start: {
          line: 869,
          column: 10
        },
        end: {
          line: 869,
          column: 35
        }
      },
      "42": {
        start: {
          line: 870,
          column: 10
        },
        end: {
          line: 901,
          column: 13
        }
      },
      "43": {
        start: {
          line: 871,
          column: 12
        },
        end: {
          line: 871,
          column: 36
        }
      },
      "44": {
        start: {
          line: 872,
          column: 12
        },
        end: {
          line: 872,
          column: 37
        }
      },
      "45": {
        start: {
          line: 874,
          column: 12
        },
        end: {
          line: 880,
          column: 13
        }
      },
      "46": {
        start: {
          line: 875,
          column: 14
        },
        end: {
          line: 875,
          column: 41
        }
      },
      "47": {
        start: {
          line: 876,
          column: 14
        },
        end: {
          line: 876,
          column: 39
        }
      },
      "48": {
        start: {
          line: 877,
          column: 14
        },
        end: {
          line: 877,
          column: 64
        }
      },
      "49": {
        start: {
          line: 879,
          column: 14
        },
        end: {
          line: 879,
          column: 41
        }
      },
      "50": {
        start: {
          line: 883,
          column: 12
        },
        end: {
          line: 883,
          column: 37
        }
      },
      "51": {
        start: {
          line: 884,
          column: 12
        },
        end: {
          line: 900,
          column: 15
        }
      },
      "52": {
        start: {
          line: 885,
          column: 14
        },
        end: {
          line: 885,
          column: 38
        }
      },
      "53": {
        start: {
          line: 886,
          column: 14
        },
        end: {
          line: 886,
          column: 39
        }
      },
      "54": {
        start: {
          line: 888,
          column: 14
        },
        end: {
          line: 894,
          column: 15
        }
      },
      "55": {
        start: {
          line: 889,
          column: 16
        },
        end: {
          line: 889,
          column: 43
        }
      },
      "56": {
        start: {
          line: 890,
          column: 16
        },
        end: {
          line: 890,
          column: 41
        }
      },
      "57": {
        start: {
          line: 891,
          column: 16
        },
        end: {
          line: 891,
          column: 66
        }
      },
      "58": {
        start: {
          line: 893,
          column: 16
        },
        end: {
          line: 893,
          column: 43
        }
      },
      "59": {
        start: {
          line: 896,
          column: 14
        },
        end: {
          line: 896,
          column: 39
        }
      },
      "60": {
        start: {
          line: 897,
          column: 14
        },
        end: {
          line: 899,
          column: 17
        }
      },
      "61": {
        start: {
          line: 898,
          column: 16
        },
        end: {
          line: 898,
          column: 40
        }
      },
      "62": {
        start: {
          line: 902,
          column: 10
        },
        end: {
          line: 902,
          column: 35
        }
      },
      "63": {
        start: {
          line: 903,
          column: 10
        },
        end: {
          line: 920,
          column: 13
        }
      },
      "64": {
        start: {
          line: 904,
          column: 12
        },
        end: {
          line: 904,
          column: 36
        }
      },
      "65": {
        start: {
          line: 905,
          column: 12
        },
        end: {
          line: 905,
          column: 37
        }
      },
      "66": {
        start: {
          line: 907,
          column: 12
        },
        end: {
          line: 915,
          column: 13
        }
      },
      "67": {
        start: {
          line: 908,
          column: 14
        },
        end: {
          line: 908,
          column: 41
        }
      },
      "68": {
        start: {
          line: 909,
          column: 14
        },
        end: {
          line: 909,
          column: 39
        }
      },
      "69": {
        start: {
          line: 910,
          column: 14
        },
        end: {
          line: 912,
          column: 17
        }
      },
      "70": {
        start: {
          line: 914,
          column: 14
        },
        end: {
          line: 914,
          column: 41
        }
      },
      "71": {
        start: {
          line: 917,
          column: 12
        },
        end: {
          line: 917,
          column: 36
        }
      },
      "72": {
        start: {
          line: 918,
          column: 12
        },
        end: {
          line: 918,
          column: 37
        }
      },
      "73": {
        start: {
          line: 919,
          column: 12
        },
        end: {
          line: 919,
          column: 24
        }
      },
      "74": {
        start: {
          line: 921,
          column: 10
        },
        end: {
          line: 921,
          column: 35
        }
      },
      "75": {
        start: {
          line: 922,
          column: 10
        },
        end: {
          line: 922,
          column: 59
        }
      },
      "76": {
        start: {
          line: 923,
          column: 10
        },
        end: {
          line: 923,
          column: 35
        }
      },
      "77": {
        start: {
          line: 924,
          column: 10
        },
        end: {
          line: 924,
          column: 59
        }
      },
      "78": {
        start: {
          line: 926,
          column: 10
        },
        end: {
          line: 926,
          column: 37
        }
      },
      "79": {
        start: {
          line: 927,
          column: 10
        },
        end: {
          line: 927,
          column: 35
        }
      },
      "80": {
        start: {
          line: 928,
          column: 10
        },
        end: {
          line: 928,
          column: 89
        }
      },
      "81": {
        start: {
          line: 931,
          column: 8
        },
        end: {
          line: 931,
          column: 35
        }
      },
      "82": {
        start: {
          line: 932,
          column: 8
        },
        end: {
          line: 932,
          column: 33
        }
      },
      "83": {
        start: {
          line: 933,
          column: 8
        },
        end: {
          line: 933,
          column: 24
        }
      },
      "84": {
        start: {
          line: 934,
          column: 8
        },
        end: {
          line: 934,
          column: 33
        }
      },
      "85": {
        start: {
          line: 935,
          column: 8
        },
        end: {
          line: 935,
          column: 195
        }
      }
    },
    fnMap: {
      "0": {
        name: "cov_1a30s2zokw",
        decl: {
          start: {
            line: 1,
            column: 9
          },
          end: {
            line: 1,
            column: 23
          }
        },
        loc: {
          start: {
            line: 1,
            column: 26
          },
          end: {
            line: 825,
            column: 1
          }
        },
        line: 1
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 820,
            column: 21
          },
          end: {
            line: 820,
            column: 22
          }
        },
        loc: {
          start: {
            line: 820,
            column: 33
          },
          end: {
            line: 822,
            column: 5
          }
        },
        line: 820
      },
      "2": {
        name: "fileUpload",
        decl: {
          start: {
            line: 842,
            column: 26
          },
          end: {
            line: 842,
            column: 36
          }
        },
        loc: {
          start: {
            line: 842,
            column: 39
          },
          end: {
            line: 939,
            column: 1
          }
        },
        line: 842
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 845,
            column: 9
          },
          end: {
            line: 845,
            column: 10
          }
        },
        loc: {
          start: {
            line: 845,
            column: 68
          },
          end: {
            line: 938,
            column: 3
          }
        },
        line: 845
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 870,
            column: 126
          },
          end: {
            line: 870,
            column: 127
          }
        },
        loc: {
          start: {
            line: 870,
            column: 145
          },
          end: {
            line: 901,
            column: 11
          }
        },
        line: 870
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 884,
            column: 57
          },
          end: {
            line: 884,
            column: 58
          }
        },
        loc: {
          start: {
            line: 884,
            column: 72
          },
          end: {
            line: 900,
            column: 13
          }
        },
        line: 884
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 897,
            column: 27
          },
          end: {
            line: 897,
            column: 28
          }
        },
        loc: {
          start: {
            line: 897,
            column: 39
          },
          end: {
            line: 899,
            column: 15
          }
        },
        line: 897
      },
      "7": {
        name: "(anonymous_7)",
        decl: {
          start: {
            line: 903,
            column: 56
          },
          end: {
            line: 903,
            column: 57
          }
        },
        loc: {
          start: {
            line: 903,
            column: 90
          },
          end: {
            line: 916,
            column: 11
          }
        },
        line: 903
      },
      "8": {
        name: "(anonymous_8)",
        decl: {
          start: {
            line: 916,
            column: 19
          },
          end: {
            line: 916,
            column: 20
          }
        },
        loc: {
          start: {
            line: 916,
            column: 37
          },
          end: {
            line: 920,
            column: 11
          }
        },
        line: 916
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 811,
            column: 17
          },
          end: {
            line: 811,
            column: 50
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 811,
            column: 17
          },
          end: {
            line: 811,
            column: 28
          }
        }, {
          start: {
            line: 811,
            column: 33
          },
          end: {
            line: 811,
            column: 49
          }
        }],
        line: 811
      },
      "1": {
        loc: {
          start: {
            line: 813,
            column: 2
          },
          end: {
            line: 815,
            column: 3
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 813,
            column: 2
          },
          end: {
            line: 815,
            column: 3
          }
        }, {
          start: {
            line: 813,
            column: 2
          },
          end: {
            line: 815,
            column: 3
          }
        }],
        line: 813
      },
      "2": {
        loc: {
          start: {
            line: 813,
            column: 6
          },
          end: {
            line: 813,
            column: 53
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 813,
            column: 6
          },
          end: {
            line: 813,
            column: 21
          }
        }, {
          start: {
            line: 813,
            column: 25
          },
          end: {
            line: 813,
            column: 53
          }
        }],
        line: 813
      },
      "3": {
        loc: {
          start: {
            line: 852,
            column: 4
          },
          end: {
            line: 937,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 852,
            column: 4
          },
          end: {
            line: 937,
            column: 5
          }
        }, {
          start: {
            line: 852,
            column: 4
          },
          end: {
            line: 937,
            column: 5
          }
        }],
        line: 852
      },
      "4": {
        loc: {
          start: {
            line: 862,
            column: 6
          },
          end: {
            line: 936,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 862,
            column: 6
          },
          end: {
            line: 936,
            column: 7
          }
        }, {
          start: {
            line: 862,
            column: 6
          },
          end: {
            line: 936,
            column: 7
          }
        }],
        line: 862
      },
      "5": {
        loc: {
          start: {
            line: 862,
            column: 10
          },
          end: {
            line: 862,
            column: 147
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 862,
            column: 11
          },
          end: {
            line: 862,
            column: 64
          }
        }, {
          start: {
            line: 862,
            column: 70
          },
          end: {
            line: 862,
            column: 146
          }
        }],
        line: 862
      },
      "6": {
        loc: {
          start: {
            line: 867,
            column: 8
          },
          end: {
            line: 929,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 867,
            column: 8
          },
          end: {
            line: 929,
            column: 9
          }
        }, {
          start: {
            line: 867,
            column: 8
          },
          end: {
            line: 929,
            column: 9
          }
        }],
        line: 867
      },
      "7": {
        loc: {
          start: {
            line: 874,
            column: 12
          },
          end: {
            line: 880,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 874,
            column: 12
          },
          end: {
            line: 880,
            column: 13
          }
        }, {
          start: {
            line: 874,
            column: 12
          },
          end: {
            line: 880,
            column: 13
          }
        }],
        line: 874
      },
      "8": {
        loc: {
          start: {
            line: 888,
            column: 14
          },
          end: {
            line: 894,
            column: 15
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 888,
            column: 14
          },
          end: {
            line: 894,
            column: 15
          }
        }, {
          start: {
            line: 888,
            column: 14
          },
          end: {
            line: 894,
            column: 15
          }
        }],
        line: 888
      },
      "9": {
        loc: {
          start: {
            line: 907,
            column: 12
          },
          end: {
            line: 915,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 907,
            column: 12
          },
          end: {
            line: 915,
            column: 13
          }
        }, {
          start: {
            line: 907,
            column: 12
          },
          end: {
            line: 915,
            column: 13
          }
        }],
        line: 907
      },
      "10": {
        loc: {
          start: {
            line: 935,
            column: 77
          },
          end: {
            line: 935,
            column: 190
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 935,
            column: 97
          },
          end: {
            line: 935,
            column: 153
          }
        }, {
          start: {
            line: 935,
            column: 158
          },
          end: {
            line: 935,
            column: 189
          }
        }],
        line: 935
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0,
      "31": 0,
      "32": 0,
      "33": 0,
      "34": 0,
      "35": 0,
      "36": 0,
      "37": 0,
      "38": 0,
      "39": 0,
      "40": 0,
      "41": 0,
      "42": 0,
      "43": 0,
      "44": 0,
      "45": 0,
      "46": 0,
      "47": 0,
      "48": 0,
      "49": 0,
      "50": 0,
      "51": 0,
      "52": 0,
      "53": 0,
      "54": 0,
      "55": 0,
      "56": 0,
      "57": 0,
      "58": 0,
      "59": 0,
      "60": 0,
      "61": 0,
      "62": 0,
      "63": 0,
      "64": 0,
      "65": 0,
      "66": 0,
      "67": 0,
      "68": 0,
      "69": 0,
      "70": 0,
      "71": 0,
      "72": 0,
      "73": 0,
      "74": 0,
      "75": 0,
      "76": 0,
      "77": 0,
      "78": 0,
      "79": 0,
      "80": 0,
      "81": 0,
      "82": 0,
      "83": 0,
      "84": 0,
      "85": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0],
      "8": [0, 0],
      "9": [0, 0],
      "10": [0, 0]
    },
    inputSourceMap: {
      version: 3,
      names: ["fs", "Request", "Response", "NextFunction", "UserModel", "utils", "require", "security", "logger", "fileType", "module", "exports", "fileUpload", "req", "res", "next", "file", "buffer", "uploadedFileType", "fromBuffer", "undefined", "status", "Error", "startsWith", "mime", "loggedInUser", "authenticatedUsers", "get", "cookies", "token", "open", "data", "id", "ext", "err", "fd", "warn", "message", "write", "length", "close", "findByPk", "then", "user", "update", "profileImage", "catch", "error", "location", "process", "env", "BASE_PATH", "redirect", "connection", "remoteAddress"],
      sources: ["profileImageFileUpload.ts"],
      sourcesContent: ["/*\n * Copyright (c) 2014-2022 Bjoern Kimminich & the OWASP Juice Shop contributors.\n * SPDX-License-Identifier: MIT\n */\n\nimport fs = require('fs')\nimport { Request, Response, NextFunction } from 'express'\nimport { UserModel } from '../models/user'\n\nconst utils = require('../lib/utils')\nconst security = require('../lib/insecurity')\nconst logger = require('../lib/logger')\nconst fileType = require('file-type')\n\nmodule.exports = function fileUpload () {\n  return async (req: Request, res: Response, next: NextFunction) => {\n    const file = req.file\n    const buffer = file?.buffer\n    const uploadedFileType = await fileType.fromBuffer(buffer)\n\n    if (uploadedFileType === undefined) {\n      res.status(500)\n      next(new Error('Illegal file type'))\n    } else {\n      if (uploadedFileType !== null && utils.startsWith(uploadedFileType.mime, 'image')) {\n        const loggedInUser = security.authenticatedUsers.get(req.cookies.token)\n        if (loggedInUser) {\n          fs.open(`frontend/dist/frontend/assets/public/images/uploads/${loggedInUser.data.id}.${uploadedFileType.ext}`, 'w', function (err, fd) {\n            if (err != null) logger.warn('Error opening file: ' + err.message)\n            // @ts-expect-error\n            fs.write(fd, buffer, 0, buffer.length, null, function (err) {\n              if (err != null) logger.warn('Error writing file: ' + err.message)\n              fs.close(fd, function () { })\n            })\n          })\n          UserModel.findByPk(loggedInUser.data.id).then(async (user: UserModel | null) => {\n            if (user) {\n              return await user.update({ profileImage: `assets/public/images/uploads/${loggedInUser.data.id}.${uploadedFileType.ext}` })\n            }\n          }).catch((error: Error) => {\n            next(error)\n          })\n          res.location(process.env.BASE_PATH + '/profile')\n          res.redirect(process.env.BASE_PATH + '/profile')\n        } else {\n          next(new Error('Blocked illegal activity by ' + req.connection.remoteAddress))\n        }\n      } else {\n        res.status(415)\n        next(new Error(`Profile image upload does not accept this file type${uploadedFileType ? (': ' + uploadedFileType.mime) : '.'}`))\n      }\n    }\n  }\n}\n"],
      mappings: "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"
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "386a306e799f418c490e96232f18629b7ce9ef60"
  };
  var coverage = global[gcv] || (global[gcv] = {});

  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }

  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_w7ki12b4d = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}

cov_w7ki12b4d();

function cov_1a30s2zokw() {
  cov_w7ki12b4d().f[0]++;
  var path = (cov_w7ki12b4d().s[0]++, "/home/shubham/Desktop/juice-shop/routes/profileImageFileUpload.ts");
  var hash = (cov_w7ki12b4d().s[1]++, "2c8624e0db3460b96f251a4518efd179fa052791");
  var global = (cov_w7ki12b4d().s[2]++, new Function("return this")());
  var gcv = (cov_w7ki12b4d().s[3]++, "__coverage__");
  var coverageData = (cov_w7ki12b4d().s[4]++, {
    path: "/home/shubham/Desktop/juice-shop/routes/profileImageFileUpload.ts",
    statementMap: {
      "0": {
        start: {
          line: 10,
          column: 14
        },
        end: {
          line: 10,
          column: 37
        }
      },
      "1": {
        start: {
          line: 11,
          column: 17
        },
        end: {
          line: 11,
          column: 45
        }
      },
      "2": {
        start: {
          line: 12,
          column: 15
        },
        end: {
          line: 12,
          column: 39
        }
      },
      "3": {
        start: {
          line: 13,
          column: 17
        },
        end: {
          line: 13,
          column: 37
        }
      },
      "4": {
        start: {
          line: 15,
          column: 0
        },
        end: {
          line: 54,
          column: 1
        }
      },
      "5": {
        start: {
          line: 16,
          column: 2
        },
        end: {
          line: 53,
          column: 3
        }
      },
      "6": {
        start: {
          line: 17,
          column: 17
        },
        end: {
          line: 17,
          column: 25
        }
      },
      "7": {
        start: {
          line: 18,
          column: 19
        },
        end: {
          line: 18,
          column: 31
        }
      },
      "8": {
        start: {
          line: 19,
          column: 29
        },
        end: {
          line: 19,
          column: 62
        }
      },
      "9": {
        start: {
          line: 21,
          column: 4
        },
        end: {
          line: 52,
          column: 5
        }
      },
      "10": {
        start: {
          line: 22,
          column: 6
        },
        end: {
          line: 22,
          column: 21
        }
      },
      "11": {
        start: {
          line: 23,
          column: 6
        },
        end: {
          line: 23,
          column: 42
        }
      },
      "12": {
        start: {
          line: 25,
          column: 6
        },
        end: {
          line: 51,
          column: 7
        }
      },
      "13": {
        start: {
          line: 26,
          column: 29
        },
        end: {
          line: 26,
          column: 79
        }
      },
      "14": {
        start: {
          line: 27,
          column: 8
        },
        end: {
          line: 47,
          column: 9
        }
      },
      "15": {
        start: {
          line: 28,
          column: 10
        },
        end: {
          line: 35,
          column: 12
        }
      },
      "16": {
        start: {
          line: 29,
          column: 12
        },
        end: {
          line: 29,
          column: 78
        }
      },
      "17": {
        start: {
          line: 29,
          column: 29
        },
        end: {
          line: 29,
          column: 78
        }
      },
      "18": {
        start: {
          line: 31,
          column: 12
        },
        end: {
          line: 34,
          column: 14
        }
      },
      "19": {
        start: {
          line: 32,
          column: 14
        },
        end: {
          line: 32,
          column: 80
        }
      },
      "20": {
        start: {
          line: 32,
          column: 31
        },
        end: {
          line: 32,
          column: 80
        }
      },
      "21": {
        start: {
          line: 33,
          column: 14
        },
        end: {
          line: 33,
          column: 43
        }
      },
      "22": {
        start: {
          line: 36,
          column: 10
        },
        end: {
          line: 42,
          column: 12
        }
      },
      "23": {
        start: {
          line: 37,
          column: 12
        },
        end: {
          line: 39,
          column: 13
        }
      },
      "24": {
        start: {
          line: 38,
          column: 14
        },
        end: {
          line: 38,
          column: 136
        }
      },
      "25": {
        start: {
          line: 41,
          column: 12
        },
        end: {
          line: 41,
          column: 23
        }
      },
      "26": {
        start: {
          line: 43,
          column: 10
        },
        end: {
          line: 43,
          column: 58
        }
      },
      "27": {
        start: {
          line: 44,
          column: 10
        },
        end: {
          line: 44,
          column: 58
        }
      },
      "28": {
        start: {
          line: 46,
          column: 10
        },
        end: {
          line: 46,
          column: 88
        }
      },
      "29": {
        start: {
          line: 49,
          column: 8
        },
        end: {
          line: 49,
          column: 23
        }
      },
      "30": {
        start: {
          line: 50,
          column: 8
        },
        end: {
          line: 50,
          column: 136
        }
      }
    },
    fnMap: {
      "0": {
        name: "fileUpload",
        decl: {
          start: {
            line: 15,
            column: 26
          },
          end: {
            line: 15,
            column: 36
          }
        },
        loc: {
          start: {
            line: 15,
            column: 40
          },
          end: {
            line: 54,
            column: 1
          }
        },
        line: 15
      },
      "1": {
        name: "(anonymous_1)",
        decl: {
          start: {
            line: 16,
            column: 9
          },
          end: {
            line: 16,
            column: 10
          }
        },
        loc: {
          start: {
            line: 16,
            column: 68
          },
          end: {
            line: 53,
            column: 3
          }
        },
        line: 16
      },
      "2": {
        name: "(anonymous_2)",
        decl: {
          start: {
            line: 28,
            column: 126
          },
          end: {
            line: 28,
            column: 127
          }
        },
        loc: {
          start: {
            line: 28,
            column: 145
          },
          end: {
            line: 35,
            column: 11
          }
        },
        line: 28
      },
      "3": {
        name: "(anonymous_3)",
        decl: {
          start: {
            line: 31,
            column: 57
          },
          end: {
            line: 31,
            column: 58
          }
        },
        loc: {
          start: {
            line: 31,
            column: 72
          },
          end: {
            line: 34,
            column: 13
          }
        },
        line: 31
      },
      "4": {
        name: "(anonymous_4)",
        decl: {
          start: {
            line: 33,
            column: 27
          },
          end: {
            line: 33,
            column: 28
          }
        },
        loc: {
          start: {
            line: 33,
            column: 39
          },
          end: {
            line: 33,
            column: 42
          }
        },
        line: 33
      },
      "5": {
        name: "(anonymous_5)",
        decl: {
          start: {
            line: 36,
            column: 56
          },
          end: {
            line: 36,
            column: 57
          }
        },
        loc: {
          start: {
            line: 36,
            column: 90
          },
          end: {
            line: 40,
            column: 11
          }
        },
        line: 36
      },
      "6": {
        name: "(anonymous_6)",
        decl: {
          start: {
            line: 40,
            column: 19
          },
          end: {
            line: 40,
            column: 20
          }
        },
        loc: {
          start: {
            line: 40,
            column: 37
          },
          end: {
            line: 42,
            column: 11
          }
        },
        line: 40
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 21,
            column: 4
          },
          end: {
            line: 52,
            column: 5
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 21,
            column: 4
          },
          end: {
            line: 52,
            column: 5
          }
        }, {
          start: {
            line: 21,
            column: 4
          },
          end: {
            line: 52,
            column: 5
          }
        }],
        line: 21
      },
      "1": {
        loc: {
          start: {
            line: 25,
            column: 6
          },
          end: {
            line: 51,
            column: 7
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 25,
            column: 6
          },
          end: {
            line: 51,
            column: 7
          }
        }, {
          start: {
            line: 25,
            column: 6
          },
          end: {
            line: 51,
            column: 7
          }
        }],
        line: 25
      },
      "2": {
        loc: {
          start: {
            line: 25,
            column: 10
          },
          end: {
            line: 25,
            column: 87
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 25,
            column: 10
          },
          end: {
            line: 25,
            column: 35
          }
        }, {
          start: {
            line: 25,
            column: 39
          },
          end: {
            line: 25,
            column: 87
          }
        }],
        line: 25
      },
      "3": {
        loc: {
          start: {
            line: 27,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 27,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        }, {
          start: {
            line: 27,
            column: 8
          },
          end: {
            line: 47,
            column: 9
          }
        }],
        line: 27
      },
      "4": {
        loc: {
          start: {
            line: 29,
            column: 12
          },
          end: {
            line: 29,
            column: 78
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 29,
            column: 12
          },
          end: {
            line: 29,
            column: 78
          }
        }, {
          start: {
            line: 29,
            column: 12
          },
          end: {
            line: 29,
            column: 78
          }
        }],
        line: 29
      },
      "5": {
        loc: {
          start: {
            line: 32,
            column: 14
          },
          end: {
            line: 32,
            column: 80
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 32,
            column: 14
          },
          end: {
            line: 32,
            column: 80
          }
        }, {
          start: {
            line: 32,
            column: 14
          },
          end: {
            line: 32,
            column: 80
          }
        }],
        line: 32
      },
      "6": {
        loc: {
          start: {
            line: 37,
            column: 12
          },
          end: {
            line: 39,
            column: 13
          }
        },
        type: "if",
        locations: [{
          start: {
            line: 37,
            column: 12
          },
          end: {
            line: 39,
            column: 13
          }
        }, {
          start: {
            line: 37,
            column: 12
          },
          end: {
            line: 39,
            column: 13
          }
        }],
        line: 37
      },
      "7": {
        loc: {
          start: {
            line: 50,
            column: 77
          },
          end: {
            line: 50,
            column: 132
          }
        },
        type: "cond-expr",
        locations: [{
          start: {
            line: 50,
            column: 97
          },
          end: {
            line: 50,
            column: 125
          }
        }, {
          start: {
            line: 50,
            column: 129
          },
          end: {
            line: 50,
            column: 132
          }
        }],
        line: 50
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0,
      "20": 0,
      "21": 0,
      "22": 0,
      "23": 0,
      "24": 0,
      "25": 0,
      "26": 0,
      "27": 0,
      "28": 0,
      "29": 0,
      "30": 0
    },
    f: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0, 0],
      "3": [0, 0],
      "4": [0, 0],
      "5": [0, 0],
      "6": [0, 0],
      "7": [0, 0]
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "2c8624e0db3460b96f251a4518efd179fa052791"
  });
  var coverage = (cov_w7ki12b4d().s[5]++, (cov_w7ki12b4d().b[0][0]++, global[gcv]) || (cov_w7ki12b4d().b[0][1]++, global[gcv] = {}));
  cov_w7ki12b4d().s[6]++;

  if ((cov_w7ki12b4d().b[2][0]++, !coverage[path]) || (cov_w7ki12b4d().b[2][1]++, coverage[path].hash !== hash)) {
    cov_w7ki12b4d().b[1][0]++;
    cov_w7ki12b4d().s[7]++;
    coverage[path] = coverageData;
  } else {
    cov_w7ki12b4d().b[1][1]++;
  }

  var actualCoverage = (cov_w7ki12b4d().s[8]++, coverage[path]);
  {
    cov_w7ki12b4d().s[9]++;

    // @ts-ignore
    cov_1a30s2zokw = function () {
      cov_w7ki12b4d().f[1]++;
      cov_w7ki12b4d().s[10]++;
      return actualCoverage;
    };
  }
  cov_w7ki12b4d().s[11]++;
  return actualCoverage;
}

cov_w7ki12b4d().s[12]++;
cov_1a30s2zokw();
/*
 * Copyright (c) 2014-2022 Bjoern Kimminich & the OWASP Juice Shop contributors.
 * SPDX-License-Identifier: MIT
 */

import fs = require('fs');
import { Request, Response, NextFunction } from 'express';
import { UserModel } from '../models/user';
const utils = (cov_w7ki12b4d().s[13]++, (cov_1a30s2zokw().s[0]++, require('../lib/utils')));
const security = (cov_w7ki12b4d().s[14]++, (cov_1a30s2zokw().s[1]++, require('../lib/insecurity')));
const logger = (cov_w7ki12b4d().s[15]++, (cov_1a30s2zokw().s[2]++, require('../lib/logger')));
const fileType = (cov_w7ki12b4d().s[16]++, (cov_1a30s2zokw().s[3]++, require('file-type')));
cov_w7ki12b4d().s[17]++;
cov_1a30s2zokw().s[4]++;
cov_w7ki12b4d().s[18]++;

module.exports = function fileUpload() {
  cov_w7ki12b4d().f[2]++;
  cov_w7ki12b4d().s[19]++;
  cov_1a30s2zokw().f[0]++;
  cov_w7ki12b4d().s[20]++;
  cov_1a30s2zokw().s[5]++;
  cov_w7ki12b4d().s[21]++;
  return async (req: Request, res: Response, next: NextFunction) => {
    cov_w7ki12b4d().f[3]++;
    cov_w7ki12b4d().s[22]++;
    cov_1a30s2zokw().f[1]++;
    const file = (cov_w7ki12b4d().s[23]++, (cov_1a30s2zokw().s[6]++, req.file));
    const buffer = (cov_w7ki12b4d().s[24]++, (cov_1a30s2zokw().s[7]++, file?.buffer));
    const uploadedFileType = (cov_w7ki12b4d().s[25]++, (cov_1a30s2zokw().s[8]++, await fileType.fromBuffer(buffer)));
    cov_w7ki12b4d().s[26]++;
    cov_1a30s2zokw().s[9]++;
    cov_w7ki12b4d().s[27]++;

    if (uploadedFileType === undefined) {
      cov_w7ki12b4d().b[3][0]++;
      cov_w7ki12b4d().s[28]++;
      cov_1a30s2zokw().b[0][0]++;
      cov_w7ki12b4d().s[29]++;
      cov_1a30s2zokw().s[10]++;
      cov_w7ki12b4d().s[30]++;
      res.status(500);
      cov_w7ki12b4d().s[31]++;
      cov_1a30s2zokw().s[11]++;
      cov_w7ki12b4d().s[32]++;
      next(new Error('Illegal file type'));
    } else {
      cov_w7ki12b4d().b[3][1]++;
      cov_w7ki12b4d().s[33]++;
      cov_1a30s2zokw().b[0][1]++;
      cov_w7ki12b4d().s[34]++;
      cov_1a30s2zokw().s[12]++;
      cov_w7ki12b4d().s[35]++;

      if ((cov_w7ki12b4d().b[5][0]++, (cov_1a30s2zokw().b[2][0]++, uploadedFileType !== null)) && (cov_w7ki12b4d().b[5][1]++, (cov_1a30s2zokw().b[2][1]++, utils.startsWith(uploadedFileType.mime, 'image')))) {
        cov_w7ki12b4d().b[4][0]++;
        cov_w7ki12b4d().s[36]++;
        cov_1a30s2zokw().b[1][0]++;
        const loggedInUser = (cov_w7ki12b4d().s[37]++, (cov_1a30s2zokw().s[13]++, security.authenticatedUsers.get(req.cookies.token)));
        cov_w7ki12b4d().s[38]++;
        cov_1a30s2zokw().s[14]++;
        cov_w7ki12b4d().s[39]++;

        if (loggedInUser) {
          cov_w7ki12b4d().b[6][0]++;
          cov_w7ki12b4d().s[40]++;
          cov_1a30s2zokw().b[3][0]++;
          cov_w7ki12b4d().s[41]++;
          cov_1a30s2zokw().s[15]++;
          cov_w7ki12b4d().s[42]++;
          fs.open(`frontend/dist/frontend/assets/public/images/uploads/${loggedInUser.data.id}.${uploadedFileType.ext}`, 'w', function (err, fd) {
            cov_w7ki12b4d().f[4]++;
            cov_w7ki12b4d().s[43]++;
            cov_1a30s2zokw().f[2]++;
            cov_w7ki12b4d().s[44]++;
            cov_1a30s2zokw().s[16]++;
            cov_w7ki12b4d().s[45]++;

            if (err != null) {
              cov_w7ki12b4d().b[7][0]++;
              cov_w7ki12b4d().s[46]++;
              cov_1a30s2zokw().b[4][0]++;
              cov_w7ki12b4d().s[47]++;
              cov_1a30s2zokw().s[17]++;
              cov_w7ki12b4d().s[48]++;
              logger.warn('Error opening file: ' + err.message);
            } else {
              cov_w7ki12b4d().b[7][1]++;
              cov_w7ki12b4d().s[49]++;
              cov_1a30s2zokw().b[4][1]++;
            } // @ts-expect-error


            cov_w7ki12b4d().s[50]++;
            cov_1a30s2zokw().s[18]++;
            cov_w7ki12b4d().s[51]++;
            fs.write(fd, buffer, 0, buffer.length, null, function (err) {
              cov_w7ki12b4d().f[5]++;
              cov_w7ki12b4d().s[52]++;
              cov_1a30s2zokw().f[3]++;
              cov_w7ki12b4d().s[53]++;
              cov_1a30s2zokw().s[19]++;
              cov_w7ki12b4d().s[54]++;

              if (err != null) {
                cov_w7ki12b4d().b[8][0]++;
                cov_w7ki12b4d().s[55]++;
                cov_1a30s2zokw().b[5][0]++;
                cov_w7ki12b4d().s[56]++;
                cov_1a30s2zokw().s[20]++;
                cov_w7ki12b4d().s[57]++;
                logger.warn('Error writing file: ' + err.message);
              } else {
                cov_w7ki12b4d().b[8][1]++;
                cov_w7ki12b4d().s[58]++;
                cov_1a30s2zokw().b[5][1]++;
              }

              cov_w7ki12b4d().s[59]++;
              cov_1a30s2zokw().s[21]++;
              cov_w7ki12b4d().s[60]++;
              fs.close(fd, function () {
                cov_w7ki12b4d().f[6]++;
                cov_w7ki12b4d().s[61]++;
                cov_1a30s2zokw().f[4]++;
              });
            });
          });
          cov_w7ki12b4d().s[62]++;
          cov_1a30s2zokw().s[22]++;
          cov_w7ki12b4d().s[63]++;
          UserModel.findByPk(loggedInUser.data.id).then(async (user: UserModel | null) => {
            cov_w7ki12b4d().f[7]++;
            cov_w7ki12b4d().s[64]++;
            cov_1a30s2zokw().f[5]++;
            cov_w7ki12b4d().s[65]++;
            cov_1a30s2zokw().s[23]++;
            cov_w7ki12b4d().s[66]++;

            if (user) {
              cov_w7ki12b4d().b[9][0]++;
              cov_w7ki12b4d().s[67]++;
              cov_1a30s2zokw().b[6][0]++;
              cov_w7ki12b4d().s[68]++;
              cov_1a30s2zokw().s[24]++;
              cov_w7ki12b4d().s[69]++;
              return await user.update({
                profileImage: `assets/public/images/uploads/${loggedInUser.data.id}.${uploadedFileType.ext}`
              });
            } else {
              cov_w7ki12b4d().b[9][1]++;
              cov_w7ki12b4d().s[70]++;
              cov_1a30s2zokw().b[6][1]++;
            }
          }).catch((error: Error) => {
            cov_w7ki12b4d().f[8]++;
            cov_w7ki12b4d().s[71]++;
            cov_1a30s2zokw().f[6]++;
            cov_w7ki12b4d().s[72]++;
            cov_1a30s2zokw().s[25]++;
            cov_w7ki12b4d().s[73]++;
            next(error);
          });
          cov_w7ki12b4d().s[74]++;
          cov_1a30s2zokw().s[26]++;
          cov_w7ki12b4d().s[75]++;
          res.location(process.env.BASE_PATH + '/profile');
          cov_w7ki12b4d().s[76]++;
          cov_1a30s2zokw().s[27]++;
          cov_w7ki12b4d().s[77]++;
          res.redirect(process.env.BASE_PATH + '/profile');
        } else {
          cov_w7ki12b4d().b[6][1]++;
          cov_w7ki12b4d().s[78]++;
          cov_1a30s2zokw().b[3][1]++;
          cov_w7ki12b4d().s[79]++;
          cov_1a30s2zokw().s[28]++;
          cov_w7ki12b4d().s[80]++;
          next(new Error('Blocked illegal activity by ' + req.connection.remoteAddress));
        }
      } else {
        cov_w7ki12b4d().b[4][1]++;
        cov_w7ki12b4d().s[81]++;
        cov_1a30s2zokw().b[1][1]++;
        cov_w7ki12b4d().s[82]++;
        cov_1a30s2zokw().s[29]++;
        cov_w7ki12b4d().s[83]++;
        res.status(415);
        cov_w7ki12b4d().s[84]++;
        cov_1a30s2zokw().s[30]++;
        cov_w7ki12b4d().s[85]++;
        next(new Error(`Profile image upload does not accept this file type${uploadedFileType ? (cov_w7ki12b4d().b[10][0]++, (cov_1a30s2zokw().b[7][0]++, ': ' + uploadedFileType.mime)) : (cov_w7ki12b4d().b[10][1]++, (cov_1a30s2zokw().b[7][1]++, '.'))}`));
      }
    }
  };
}; //# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJmcyIsIlJlcXVlc3QiLCJSZXNwb25zZSIsIk5leHRGdW5jdGlvbiIsIlVzZXJNb2RlbCIsInV0aWxzIiwicmVxdWlyZSIsInNlY3VyaXR5IiwibG9nZ2VyIiwiZmlsZVR5cGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZmlsZVVwbG9hZCIsInJlcSIsInJlcyIsIm5leHQiLCJmaWxlIiwiYnVmZmVyIiwidXBsb2FkZWRGaWxlVHlwZSIsImZyb21CdWZmZXIiLCJ1bmRlZmluZWQiLCJzdGF0dXMiLCJFcnJvciIsInN0YXJ0c1dpdGgiLCJtaW1lIiwibG9nZ2VkSW5Vc2VyIiwiYXV0aGVudGljYXRlZFVzZXJzIiwiZ2V0IiwiY29va2llcyIsInRva2VuIiwib3BlbiIsImRhdGEiLCJpZCIsImV4dCIsImVyciIsImZkIiwid2FybiIsIm1lc3NhZ2UiLCJ3cml0ZSIsImxlbmd0aCIsImNsb3NlIiwiZmluZEJ5UGsiLCJ0aGVuIiwidXNlciIsInVwZGF0ZSIsInByb2ZpbGVJbWFnZSIsImNhdGNoIiwiZXJyb3IiLCJsb2NhdGlvbiIsInByb2Nlc3MiLCJlbnYiLCJCQVNFX1BBVEgiLCJyZWRpcmVjdCIsImNvbm5lY3Rpb24iLCJyZW1vdGVBZGRyZXNzIl0sInNvdXJjZXMiOlsicHJvZmlsZUltYWdlRmlsZVVwbG9hZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChjKSAyMDE0LTIwMjIgQmpvZXJuIEtpbW1pbmljaCAmIHRoZSBPV0FTUCBKdWljZSBTaG9wIGNvbnRyaWJ1dG9ycy5cbiAqIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBNSVRcbiAqL1xuXG5pbXBvcnQgZnMgPSByZXF1aXJlKCdmcycpXG5pbXBvcnQgeyBSZXF1ZXN0LCBSZXNwb25zZSwgTmV4dEZ1bmN0aW9uIH0gZnJvbSAnZXhwcmVzcydcbmltcG9ydCB7IFVzZXJNb2RlbCB9IGZyb20gJy4uL21vZGVscy91c2VyJ1xuXG5jb25zdCB1dGlscyA9IHJlcXVpcmUoJy4uL2xpYi91dGlscycpXG5jb25zdCBzZWN1cml0eSA9IHJlcXVpcmUoJy4uL2xpYi9pbnNlY3VyaXR5JylcbmNvbnN0IGxvZ2dlciA9IHJlcXVpcmUoJy4uL2xpYi9sb2dnZXInKVxuY29uc3QgZmlsZVR5cGUgPSByZXF1aXJlKCdmaWxlLXR5cGUnKVxuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGZpbGVVcGxvYWQgKCkge1xuICByZXR1cm4gYXN5bmMgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSwgbmV4dDogTmV4dEZ1bmN0aW9uKSA9PiB7XG4gICAgY29uc3QgZmlsZSA9IHJlcS5maWxlXG4gICAgY29uc3QgYnVmZmVyID0gZmlsZT8uYnVmZmVyXG4gICAgY29uc3QgdXBsb2FkZWRGaWxlVHlwZSA9IGF3YWl0IGZpbGVUeXBlLmZyb21CdWZmZXIoYnVmZmVyKVxuXG4gICAgaWYgKHVwbG9hZGVkRmlsZVR5cGUgPT09IHVuZGVmaW5lZCkge1xuICAgICAgcmVzLnN0YXR1cyg1MDApXG4gICAgICBuZXh0KG5ldyBFcnJvcignSWxsZWdhbCBmaWxlIHR5cGUnKSlcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKHVwbG9hZGVkRmlsZVR5cGUgIT09IG51bGwgJiYgdXRpbHMuc3RhcnRzV2l0aCh1cGxvYWRlZEZpbGVUeXBlLm1pbWUsICdpbWFnZScpKSB7XG4gICAgICAgIGNvbnN0IGxvZ2dlZEluVXNlciA9IHNlY3VyaXR5LmF1dGhlbnRpY2F0ZWRVc2Vycy5nZXQocmVxLmNvb2tpZXMudG9rZW4pXG4gICAgICAgIGlmIChsb2dnZWRJblVzZXIpIHtcbiAgICAgICAgICBmcy5vcGVuKGBmcm9udGVuZC9kaXN0L2Zyb250ZW5kL2Fzc2V0cy9wdWJsaWMvaW1hZ2VzL3VwbG9hZHMvJHtsb2dnZWRJblVzZXIuZGF0YS5pZH0uJHt1cGxvYWRlZEZpbGVUeXBlLmV4dH1gLCAndycsIGZ1bmN0aW9uIChlcnIsIGZkKSB7XG4gICAgICAgICAgICBpZiAoZXJyICE9IG51bGwpIGxvZ2dlci53YXJuKCdFcnJvciBvcGVuaW5nIGZpbGU6ICcgKyBlcnIubWVzc2FnZSlcbiAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICAgICAgICAgIGZzLndyaXRlKGZkLCBidWZmZXIsIDAsIGJ1ZmZlci5sZW5ndGgsIG51bGwsIGZ1bmN0aW9uIChlcnIpIHtcbiAgICAgICAgICAgICAgaWYgKGVyciAhPSBudWxsKSBsb2dnZXIud2FybignRXJyb3Igd3JpdGluZyBmaWxlOiAnICsgZXJyLm1lc3NhZ2UpXG4gICAgICAgICAgICAgIGZzLmNsb3NlKGZkLCBmdW5jdGlvbiAoKSB7IH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgIH0pXG4gICAgICAgICAgVXNlck1vZGVsLmZpbmRCeVBrKGxvZ2dlZEluVXNlci5kYXRhLmlkKS50aGVuKGFzeW5jICh1c2VyOiBVc2VyTW9kZWwgfCBudWxsKSA9PiB7XG4gICAgICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgdXNlci51cGRhdGUoeyBwcm9maWxlSW1hZ2U6IGBhc3NldHMvcHVibGljL2ltYWdlcy91cGxvYWRzLyR7bG9nZ2VkSW5Vc2VyLmRhdGEuaWR9LiR7dXBsb2FkZWRGaWxlVHlwZS5leHR9YCB9KVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pLmNhdGNoKChlcnJvcjogRXJyb3IpID0+IHtcbiAgICAgICAgICAgIG5leHQoZXJyb3IpXG4gICAgICAgICAgfSlcbiAgICAgICAgICByZXMubG9jYXRpb24ocHJvY2Vzcy5lbnYuQkFTRV9QQVRIICsgJy9wcm9maWxlJylcbiAgICAgICAgICByZXMucmVkaXJlY3QocHJvY2Vzcy5lbnYuQkFTRV9QQVRIICsgJy9wcm9maWxlJylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXh0KG5ldyBFcnJvcignQmxvY2tlZCBpbGxlZ2FsIGFjdGl2aXR5IGJ5ICcgKyByZXEuY29ubmVjdGlvbi5yZW1vdGVBZGRyZXNzKSlcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MTUpXG4gICAgICAgIG5leHQobmV3IEVycm9yKGBQcm9maWxlIGltYWdlIHVwbG9hZCBkb2VzIG5vdCBhY2NlcHQgdGhpcyBmaWxlIHR5cGUke3VwbG9hZGVkRmlsZVR5cGUgPyAoJzogJyArIHVwbG9hZGVkRmlsZVR5cGUubWltZSkgOiAnLid9YCkpXG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBZVk7Ozs7Ozs7Ozs7QUFmWjtBQUNBO0FBQ0E7QUFDQTtBQUVBLE9BQU9BLEVBQVAsR0FBWSxRQUFRLElBQVIsQ0FBWjtBQUNBLFNBQVNDLE9BQVQsRUFBa0JDLFFBQWxCLEVBQTRCQyxZQUE1QixRQUFnRCxTQUFoRDtBQUNBLFNBQVNDLFNBQVQsUUFBMEIsZ0JBQTFCO0FBRUEsTUFBTUMsS0FBSyw2QkFBR0MsT0FBTyxDQUFDLGNBQUQsQ0FBVixDQUFYO0FBQ0EsTUFBTUMsUUFBUSw2QkFBR0QsT0FBTyxDQUFDLG1CQUFELENBQVYsQ0FBZDtBQUNBLE1BQU1FLE1BQU0sNkJBQUdGLE9BQU8sQ0FBQyxlQUFELENBQVYsQ0FBWjtBQUNBLE1BQU1HLFFBQVEsNkJBQUdILE9BQU8sQ0FBQyxXQUFELENBQVYsQ0FBZDs7O0FBRUFJLE1BQU0sQ0FBQ0MsT0FBUCxHQUFpQixTQUFTQyxVQUFULEdBQXVCO0VBQUE7RUFBQTtFQUN0QyxPQUFPLE9BQU9DLEdBQUcsRUFBRVosT0FBWixFQUFxQmEsR0FBRyxFQUFFWixRQUExQixFQUFvQ2EsSUFBSSxFQUFFWixZQUExQyxLQUEyRDtJQUFBO0lBQ2hFLE1BQU1hLElBQUksNkJBQUdILEdBQUcsQ0FBQ0csSUFBUCxDQUFWO0lBQ0EsTUFBTUMsTUFBTSw2QkFBR0QsSUFBSSxFQUFFQyxNQUFULENBQVo7SUFDQSxNQUFNQyxnQkFBZ0IsNkJBQUcsTUFBTVQsUUFBUSxDQUFDVSxVQUFULENBQW9CRixNQUFwQixDQUFULENBQXRCO0lBSGdFOztJQUtoRSxJQUFJQyxnQkFBZ0IsS0FBS0UsU0FBekIsRUFBb0M7TUFBQTtNQUFBO01BQ2xDTixHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYO01BRGtDO01BRWxDTixJQUFJLENBQUMsSUFBSU8sS0FBSixDQUFVLG1CQUFWLENBQUQsQ0FBSjtJQUNELENBSEQsTUFHTztNQUFBO01BQUE7O01BQ0wsSUFBSSw2QkFBQUosZ0JBQWdCLEtBQUssSUFBckIsa0NBQTZCYixLQUFLLENBQUNrQixVQUFOLENBQWlCTCxnQkFBZ0IsQ0FBQ00sSUFBbEMsRUFBd0MsT0FBeEMsQ0FBN0IsQ0FBSixFQUFtRjtRQUFBO1FBQ2pGLE1BQU1DLFlBQVksOEJBQUdsQixRQUFRLENBQUNtQixrQkFBVCxDQUE0QkMsR0FBNUIsQ0FBZ0NkLEdBQUcsQ0FBQ2UsT0FBSixDQUFZQyxLQUE1QyxDQUFILENBQWxCO1FBRGlGOztRQUVqRixJQUFJSixZQUFKLEVBQWtCO1VBQUE7VUFBQTtVQUNoQnpCLEVBQUUsQ0FBQzhCLElBQUgsQ0FBUyx1REFBc0RMLFlBQVksQ0FBQ00sSUFBYixDQUFrQkMsRUFBRyxJQUFHZCxnQkFBZ0IsQ0FBQ2UsR0FBSSxFQUE1RyxFQUErRyxHQUEvRyxFQUFvSCxVQUFVQyxHQUFWLEVBQWVDLEVBQWYsRUFBbUI7WUFBQTtZQUFBOztZQUNySSxJQUFJRCxHQUFHLElBQUksSUFBWCxFQUFpQjtjQUFBO2NBQUE7Y0FBQTFCLE1BQU0sQ0FBQzRCLElBQVAsQ0FBWSx5QkFBeUJGLEdBQUcsQ0FBQ0csT0FBekM7WUFBaUQsQ0FBbEU7Y0FBQTtZQUFBLENBRHFJLENBRXJJOzs7WUFGcUk7WUFHcklyQyxFQUFFLENBQUNzQyxLQUFILENBQVNILEVBQVQsRUFBYWxCLE1BQWIsRUFBcUIsQ0FBckIsRUFBd0JBLE1BQU0sQ0FBQ3NCLE1BQS9CLEVBQXVDLElBQXZDLEVBQTZDLFVBQVVMLEdBQVYsRUFBZTtjQUFBO2NBQUE7O2NBQzFELElBQUlBLEdBQUcsSUFBSSxJQUFYLEVBQWlCO2dCQUFBO2dCQUFBO2dCQUFBMUIsTUFBTSxDQUFDNEIsSUFBUCxDQUFZLHlCQUF5QkYsR0FBRyxDQUFDRyxPQUF6QztjQUFpRCxDQUFsRTtnQkFBQTtjQUFBOztjQUQwRDtjQUUxRHJDLEVBQUUsQ0FBQ3dDLEtBQUgsQ0FBU0wsRUFBVCxFQUFhLFlBQVk7Z0JBQUE7Y0FBRyxDQUE1QjtZQUNELENBSEQ7VUFJRCxDQVBEO1VBRGdCO1VBU2hCL0IsU0FBUyxDQUFDcUMsUUFBVixDQUFtQmhCLFlBQVksQ0FBQ00sSUFBYixDQUFrQkMsRUFBckMsRUFBeUNVLElBQXpDLENBQThDLE9BQU9DLElBQUksRUFBRXZDLFNBQVMsR0FBRyxJQUF6QixLQUFrQztZQUFBO1lBQUE7O1lBQzlFLElBQUl1QyxJQUFKLEVBQVU7Y0FBQTtjQUFBO2NBQ1IsT0FBTyxNQUFNQSxJQUFJLENBQUNDLE1BQUwsQ0FBWTtnQkFBRUMsWUFBWSxFQUFHLGdDQUErQnBCLFlBQVksQ0FBQ00sSUFBYixDQUFrQkMsRUFBRyxJQUFHZCxnQkFBZ0IsQ0FBQ2UsR0FBSTtjQUE3RixDQUFaLENBQWI7WUFDRCxDQUZEO2NBQUE7WUFBQTtVQUdELENBSkQsRUFJR2EsS0FKSCxDQUlTLENBQUNDLEtBQUssRUFBRXpCLEtBQVIsS0FBa0I7WUFBQTtZQUFBO1lBQ3pCUCxJQUFJLENBQUNnQyxLQUFELENBQUo7VUFDRCxDQU5EO1VBVGdCO1VBZ0JoQmpDLEdBQUcsQ0FBQ2tDLFFBQUosQ0FBYUMsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFNBQVosR0FBd0IsVUFBckM7VUFoQmdCO1VBaUJoQnJDLEdBQUcsQ0FBQ3NDLFFBQUosQ0FBYUgsT0FBTyxDQUFDQyxHQUFSLENBQVlDLFNBQVosR0FBd0IsVUFBckM7UUFDRCxDQWxCRCxNQWtCTztVQUFBO1VBQUE7VUFDTHBDLElBQUksQ0FBQyxJQUFJTyxLQUFKLENBQVUsaUNBQWlDVCxHQUFHLENBQUN3QyxVQUFKLENBQWVDLGFBQTFELENBQUQsQ0FBSjtRQUNEO01BQ0YsQ0F2QkQsTUF1Qk87UUFBQTtRQUFBO1FBQ0x4QyxHQUFHLENBQUNPLE1BQUosQ0FBVyxHQUFYO1FBREs7UUFFTE4sSUFBSSxDQUFDLElBQUlPLEtBQUosQ0FBVyxzREFBcURKLGdCQUFnQixnQ0FBSSxPQUFPQSxnQkFBZ0IsQ0FBQ00sSUFBNUIsaUNBQW9DLEdBQXBDLENBQXdDLEVBQXhILENBQUQsQ0FBSjtNQUNEO0lBQ0Y7RUFDRixDQXJDRDtBQXNDRCxDQXZDRCJ9
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFBRjtRQUFBO1FBRUxHLElBQUksQ0FBQyxJQUFJTyxLQUFKLENBQVcsc0RBQXFESixnQkFBZ0IsNkRBQUksT0FBT0EsZ0JBQWdCLENBQUNNLElBQTVCLCtEQUFvQyxHQUFwQyxFQUF3QyxFQUF4SCxDQUFELENBQUpUO01BQ0Q7SUFDRjtFQXBDSDtBQURGLEUiLCJuYW1lcyI6WyJmcyIsIlJlcXVlc3QiLCJSZXNwb25zZSIsIk5leHRGdW5jdGlvbiIsIlVzZXJNb2RlbCIsInV0aWxzIiwicmVxdWlyZSIsInNlY3VyaXR5IiwibG9nZ2VyIiwiZmlsZVR5cGUiLCJtb2R1bGUiLCJleHBvcnRzIiwiZmlsZVVwbG9hZCIsImNvdl8xYTMwczJ6b2t3IiwicmVxIiwicmVzIiwibmV4dCIsImZpbGUiLCJidWZmZXIiLCJ1cGxvYWRlZEZpbGVUeXBlIiwiZnJvbUJ1ZmZlciIsInVuZGVmaW5lZCIsInN0YXR1cyIsIkVycm9yIiwic3RhcnRzV2l0aCIsIm1pbWUiLCJsb2dnZWRJblVzZXIiLCJhdXRoZW50aWNhdGVkVXNlcnMiLCJnZXQiLCJjb29raWVzIiwidG9rZW4iLCJvcGVuIiwiZGF0YSIsImlkIiwiZXh0IiwiZXJyIiwiZmQiLCJ3YXJuIiwibWVzc2FnZSIsIndyaXRlIiwibGVuZ3RoIiwiY2xvc2UiLCJmaW5kQnlQayIsInRoZW4iLCJ1c2VyIiwidXBkYXRlIiwicHJvZmlsZUltYWdlIiwiY2F0Y2giLCJlcnJvciIsImxvY2F0aW9uIiwicHJvY2VzcyIsImVudiIsIkJBU0VfUEFUSCIsInJlZGlyZWN0IiwiY29ubmVjdGlvbiIsInJlbW90ZUFkZHJlc3MiXSwic291cmNlcyI6WyJwcm9maWxlSW1hZ2VGaWxlVXBsb2FkLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTQtMjAyMiBCam9lcm4gS2ltbWluaWNoICYgdGhlIE9XQVNQIEp1aWNlIFNob3AgY29udHJpYnV0b3JzLlxuICogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IE1JVFxuICovXG5cbmltcG9ydCBmcyA9IHJlcXVpcmUoJ2ZzJylcbmltcG9ydCB7IFJlcXVlc3QsIFJlc3BvbnNlLCBOZXh0RnVuY3Rpb24gfSBmcm9tICdleHByZXNzJ1xuaW1wb3J0IHsgVXNlck1vZGVsIH0gZnJvbSAnLi4vbW9kZWxzL3VzZXInXG5cbmNvbnN0IHV0aWxzID0gcmVxdWlyZSgnLi4vbGliL3V0aWxzJylcbmNvbnN0IHNlY3VyaXR5ID0gcmVxdWlyZSgnLi4vbGliL2luc2VjdXJpdHknKVxuY29uc3QgbG9nZ2VyID0gcmVxdWlyZSgnLi4vbGliL2xvZ2dlcicpXG5jb25zdCBmaWxlVHlwZSA9IHJlcXVpcmUoJ2ZpbGUtdHlwZScpXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZmlsZVVwbG9hZCAoKSB7XG4gIHJldHVybiBhc3luYyAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlLCBuZXh0OiBOZXh0RnVuY3Rpb24pID0+IHtcbiAgICBjb25zdCBmaWxlID0gcmVxLmZpbGVcbiAgICBjb25zdCBidWZmZXIgPSBmaWxlPy5idWZmZXJcbiAgICBjb25zdCB1cGxvYWRlZEZpbGVUeXBlID0gYXdhaXQgZmlsZVR5cGUuZnJvbUJ1ZmZlcihidWZmZXIpXG5cbiAgICBpZiAodXBsb2FkZWRGaWxlVHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXMuc3RhdHVzKDUwMClcbiAgICAgIG5leHQobmV3IEVycm9yKCdJbGxlZ2FsIGZpbGUgdHlwZScpKVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAodXBsb2FkZWRGaWxlVHlwZSAhPT0gbnVsbCAmJiB1dGlscy5zdGFydHNXaXRoKHVwbG9hZGVkRmlsZVR5cGUubWltZSwgJ2ltYWdlJykpIHtcbiAgICAgICAgY29uc3QgbG9nZ2VkSW5Vc2VyID0gc2VjdXJpdHkuYXV0aGVudGljYXRlZFVzZXJzLmdldChyZXEuY29va2llcy50b2tlbilcbiAgICAgICAgaWYgKGxvZ2dlZEluVXNlcikge1xuICAgICAgICAgIGZzLm9wZW4oYGZyb250ZW5kL2Rpc3QvZnJvbnRlbmQvYXNzZXRzL3B1YmxpYy9pbWFnZXMvdXBsb2Fkcy8ke2xvZ2dlZEluVXNlci5kYXRhLmlkfS4ke3VwbG9hZGVkRmlsZVR5cGUuZXh0fWAsICd3JywgZnVuY3Rpb24gKGVyciwgZmQpIHtcbiAgICAgICAgICAgIGlmIChlcnIgIT0gbnVsbCkgbG9nZ2VyLndhcm4oJ0Vycm9yIG9wZW5pbmcgZmlsZTogJyArIGVyci5tZXNzYWdlKVxuICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICAgICAgZnMud3JpdGUoZmQsIGJ1ZmZlciwgMCwgYnVmZmVyLmxlbmd0aCwgbnVsbCwgZnVuY3Rpb24gKGVycikge1xuICAgICAgICAgICAgICBpZiAoZXJyICE9IG51bGwpIGxvZ2dlci53YXJuKCdFcnJvciB3cml0aW5nIGZpbGU6ICcgKyBlcnIubWVzc2FnZSlcbiAgICAgICAgICAgICAgZnMuY2xvc2UoZmQsIGZ1bmN0aW9uICgpIHsgfSlcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgfSlcbiAgICAgICAgICBVc2VyTW9kZWwuZmluZEJ5UGsobG9nZ2VkSW5Vc2VyLmRhdGEuaWQpLnRoZW4oYXN5bmMgKHVzZXI6IFVzZXJNb2RlbCB8IG51bGwpID0+IHtcbiAgICAgICAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgICAgICAgIHJldHVybiBhd2FpdCB1c2VyLnVwZGF0ZSh7IHByb2ZpbGVJbWFnZTogYGFzc2V0cy9wdWJsaWMvaW1hZ2VzL3VwbG9hZHMvJHtsb2dnZWRJblVzZXIuZGF0YS5pZH0uJHt1cGxvYWRlZEZpbGVUeXBlLmV4dH1gIH0pXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSkuY2F0Y2goKGVycm9yOiBFcnJvcikgPT4ge1xuICAgICAgICAgICAgbmV4dChlcnJvcilcbiAgICAgICAgICB9KVxuICAgICAgICAgIHJlcy5sb2NhdGlvbihwcm9jZXNzLmVudi5CQVNFX1BBVEggKyAnL3Byb2ZpbGUnKVxuICAgICAgICAgIHJlcy5yZWRpcmVjdChwcm9jZXNzLmVudi5CQVNFX1BBVEggKyAnL3Byb2ZpbGUnKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5leHQobmV3IEVycm9yKCdCbG9ja2VkIGlsbGVnYWwgYWN0aXZpdHkgYnkgJyArIHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3MpKVxuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXMuc3RhdHVzKDQxNSlcbiAgICAgICAgbmV4dChuZXcgRXJyb3IoYFByb2ZpbGUgaW1hZ2UgdXBsb2FkIGRvZXMgbm90IGFjY2VwdCB0aGlzIGZpbGUgdHlwZSR7dXBsb2FkZWRGaWxlVHlwZSA/ICgnOiAnICsgdXBsb2FkZWRGaWxlVHlwZS5taW1lKSA6ICcuJ31gKSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cbiJdfQ==